# Exploit Title: Paddelberg Topsite Script SQL-Injection Vulnerability.
# Google Dork: intext:"powered by php scripte webmaster resource"
# Date: 12. 2. 2013
# Author: Christian Inci
# Software Link: http://www.paddelberg.de/gratis-toplisten-script/gratis-download/
# Version: <= 1.24 (15. 7. 2012)
# Tested on: 1.24
# Vendor response: None, as I didn't contacted him. Anyway, he gives a shit about securing his script.

PoC/Exploit:
[base-url]/in.php?id=<site-id>
[base-url]/out.php?id=<site-id>

HTTP-Headers:
User-Agent
Referer
Accept-Language
X-Forwarded-For


If Cookie is
xxxtopo=:
and/or
xxxtopi=:

then X-Forwarded-For is reproducibly first used in a SELECT statement.

otherwise, it's depending on the configuration of the script and/or the cookies if it's a SELECT or an INSERT statement.

Everything else (User-Agent, Referer, Accept-Language) are ONLY used in an INSERT statement.



[base-url]/add.php?do=changeadd
(the form on '[base-url]/add.php')

HTTP-Header:
X-Forwarded-For

is used in an INSERT statement.

