Multiple Vulnerabilities in PMB (SIGB)
======================================
#Author         : @_ham1d, @vxroot
#Date           : 15-03-2013
#Site           : http://hexaudit.com
#Critical Lvl   : Critical
#Mail		: hexaudit[at]gmail[dot]com
=======================================

[-] Affected software description:
==================================
#Application   : PMB
#version       : <= 3.4.x
#Vendor        : http://www.pmbservices.fr
#Download      : http://www.pmbservices.fr/download/index.php
 
[*] Description :
-----------------
  
PMB is a completely free ILS (Integrated Library management System).
The domain of software for libraries is almost exclusively occupied by proprietary products.
We are some librarians, users and developers deploring this state of affairs.
  
PMB is based on web technology. This is what we sometimes call a 'web-app'.
PMB requires an HTTP server (such as Apache, but this is not an obligation), the MySQL database and the PHP language.
  
The main functions of PMB are :
  
    * Supporting the UNIMARC format
    * Authorities management (authors, publishers, series, subjects...)
    * Management of loans, holds, borrowers...
    * A user-friendly configuration
    * The ability to import full bibliographic records
    * A user-friendly OPAC integrating a browser
    * Loans management with a module designed to serve even the very small establishments
    * Serials management
    * Simple administration procedures that can be handled easily even by the library staff...
---------------------------------------------------------------------------------------------------------------------

[-] Vulnerability Description
=============================
	[*] SQL Injection
	~~~~~~~~~~~~~~~~~
	
The vulnerable code is located at /[pmb_path]/opac_css/empr.php
User input passed through the "login" parameter is not properly sanitized before being used in
a SQL request. This can be exploited to extract informations from database.

	[~] Exploit
	~~~~~~~~~~~
	
	POST http://[site]/[pmb_path]/opac_css/empr.php
	...
	DATA:
		login=[SQLi]&password=XXX&ok=ok

	[*] Cross-Site Scripting
	~~~~~~~~~~~~~~~~~~~~~~~~
	
The Vulnerable code is located at /[pmb_path]/index.php
The issue results from insufficient sanitization of user-supplied data through "page" parameter. This could permit a remote attacker to create a malicious URI link that includes hostile HTML and script code. If a user follows the malicious link, the attacker-supplied code executes in the Web browser of the victim computer.

	[~] Exploit
	~~~~~~~~~~~
	
	http://[site]/[pmb_path]/index.php?lvl=section_see&id=-1&location=1&page=[XSS]&nbr_lignes=1&dcote=&lcote=1&nc=&main=&ssub=&plettreaut=

